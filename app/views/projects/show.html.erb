<h1>Projects#show</h1>

<div class="project-details">
  <h1><%= @project.name %></h1>
  <p><%= @project.description %></p>
  
  <div class="project-status">
    <strong>Status:</strong> <%= @project.status %>
    
    <% if current_user %> <!-- Only show if user is logged in -->
      <%= form_with url: change_status_project_path(@project), method: :patch, class: 'status-form' do |form| %>
        <%= form.select :status, ['Not Started', 'In Progress', 'On Hold', 'Completed'], { selected: @project.status } %>
        <%= form.submit "Update Status" %>
      <% end %>
    <% end %>
  </div>
  
  <h2>Activity History</h2>
  <div class="activity-list">
    <% @activities.each do |activity| %>
      <div class="activity-item">
        <div class="activity-meta">
          <span class="activity-user"><%= activity.user.fullname %></span>
          <span class="activity-time"><%= time_ago_in_words(activity.created_at) %> ago</span>
        </div>
        
        <% if activity.activity_type == 'comment' %>
          <div class="activity-comment">
            <%= simple_format(activity.content) %>
          </div>
        <% else %>
          <div class="activity-status-change">
            Changed status: <%= activity.status_change %>
          </div>
        <% end %>
      </div>
    <% end %>
    
  </div>
  
  <% if current_user %> <!-- Only show if user is logged in -->
    <div class="add-comment">
      <h3>Add Comment</h3>
      <%= form_with url: add_comment_project_path(@project), method: :post do |form| %>
        <div class="field">
          <%= form.text_area :content, rows: 4, placeholder: 'Write your comment here...' %>
        </div>
        
        <div class="actions">
          <%= form.submit "Post Comment" %>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
